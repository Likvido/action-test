name: "Run all unit tests"
description: "Uses dotnet CLI to run all unit tests in the given directory/project/solution"
inputs:
  test-target:
    description: 'The path to the directory/project/solution to give to dotnet test (default is empty, which means the tool will guess)'
    required: false
    default: ''
  dotnet-version:
    description: 'The version of .NET to use (default is empty, which uses the latest version)'
    required: false
    default: ''
  framework:
    description: 'The target framework to run tests for (default is to run for all target frameworks in the csproj files for the unit test projects)'
    required: false
    default: ''
runs:
  using: "composite"
  steps:
    - name: Checkout
      uses: actions/checkout@v3

    - name: Setup .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: ${{ inputs.dotnet-version }}

    - name: Run tests
      run: |
        echo "FRAMEWORK=${{ inputs.framework }}" >> $GITHUB_ENV
        dotnet test ${FRAMEWORK:+"-f"} ${FRAMEWORK:+"$FRAMEWORK"} ${{ inputs.test-target }}
      shell: bash
